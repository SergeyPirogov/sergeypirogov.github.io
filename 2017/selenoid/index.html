<!DOCTYPE html>
<html lang="ru">
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="Automation of the routine takes precedence over mass pressure">
    <meta name="author" content="Sergey Pirogov">
    <meta name="HandheldFriendly" content="True" />

    <meta property="og:site_name" content="Automation Remarks">
    <meta property="og:type" content="article">
    <meta property="og:title" content="Как мы перешли на Selenoid">
    <meta property="og:image" content="../../../images/blog-logo.png"/>
    <meta name="referrer" content="origin">

       <meta property="og:description" content="История нашего перехода на Selenoid"/>
    <link rel="canonical" href="http://automation-remarks.com"/>
    <link rel="shortcut icon" href="../../../images/favicon.ico" type="image/x-icon">
    <link rel="icon" href="../../../images/favicon.ico" type="image/x-icon">

    <title>Automation Remarks</title>

    <link href="../../../css/github.css" rel="stylesheet">
    <!-- Bootstrap core CSS -->
    <link href="../../../css/bootstrap.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <!-- Custom styles for this template -->
    <link href="../../../css/album.css" rel="stylesheet">
    <link href="../../../css/main.css" rel="stylesheet">

    <script>
           (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
           (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
           m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
           })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

           ga('create', 'UA-57010828-1', 'auto');
           ga('send', 'pageview');
    </script>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4997089981836978"
     crossorigin="anonymous"></script>
  <body>

<header>
      <nav class="navbar fixed-top navbar-expand-lg navbar-dark bg-dark">
        <div class='container'>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarTogglerDemo01" aria-controls="navbarTogglerDemo01" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarTogglerDemo01">
          <ul class="navbar-nav mr-auto mt-2 mt-lg-0">
            <li class="nav-item">
              <a class="nav-link" href="/">Главная <span class="sr-only">(current)</span></a>
            </li>

          </ul>
          <ul class="navbar-nav">
             <li class="nav-item">
               <a class="nav-link" target=blank href="https://www.youtube.com/qaguild">Youtube</a>
             </li>
             <li class="nav-item">
               <a class="nav-link" target=blank href="https://t.me/automation_remarks_bot">Телеграм</a>
             </li>
             <li class="nav-item">
               <a class="nav-link" href="/archive.html">Архив</a>
             </li>
          </ul>
        </div>
        </div>
      </nav>
</header>

	<div class="album py-5 bg-light">
       <div class="post-container container">

        <div class="row pl-3 pr-3 training-banner-container">
                <div class="col text-center pb-3 pt-2 training-banner">
                    <a href="https://t.me/automation_remarks_bot?start=blog">Присоединяйтесь в Telegram</a>
                </div>
        </div>

            <main class="content" role="main">
                <article class="post">
                    <div class="inner inner-post">
                        <div id="push">
                            <header class="post-header">
                                <span class="post-meta">
                                    <span class="post-author">
                                        <a href="/author/index.html">Сергей Пирогов</a>
                                    </span> |
                                    <span class="post-date">
                                        24/08/2017
                                    </span>
                                </span>
                                <div class="clear"></div>
                                <h1 class="post-title">Как мы перешли на Selenoid</h1>
                            </header>

                            <section class="post-content">
                                <div class="paragraph">
<p>Наконец-то я добрался до написания заметки о <a href="https://github.com/aerokube/selenoid">Selenoid</a>. Расскажу о том, как и зачем мы его внедрили и что это
нам дало.</p>
</div>
<div class="paragraph">
<p>Еще со времен, когда я только вошел в IT в целом и в мир автоматизации в частности, я знал о таком инструменте, как Selenium Grid. Достаточно полезная
штука и, по всей видимости, очень популярная, так как заметка о <a href="http://automation-remarks.com/nastraivaiem-selenium-grid-za-5-minut/index.html">настройке грида</a>
является одной из самых читаемых.
Сам грид - штука прикольная, но очень нестабильная. Многие проекты и компании научились танцевать с бубном и настраивать грид так, чтобы он не падал.
Скажем, ребята из Яндекса наваяли свой <a href="https://www.youtube.com/watch?v=ULcE3993cZg">грид роутер</a>, ребята из Альфа-лаборатории придумали свой
<a href="https://habrahabr.ru/company/alfa/blog/331434/">кластер</a>. Когда же пришло наше время настроить инфраструктуру для запуска UI тестов, мы решили не
изобретать велосипед и взять готовое решение - <strong>Selenoid</strong>.</p>
</div>
<div class="paragraph">
<p>Почему именно Selenoid?</p>
</div>
<div class="paragraph">
<p>Все просто: его очень легко настроить, там есть докер и хорошая производительность.</p>
</div>
<div class="paragraph">
<p>Я уже давно играюсь с докером. На одном из проектов мы внедрили <a href="http://automation-remarks.com/ganiaitie-tiesty-v-kontieinierie-s-testcontainers/index.html">тест контейнеры</a>,
на другом просто запускали браузер в докере. На текущем проекте мы изначально планировали запускать тесты в безголовом хроме, но в тот момент эта функциональность
работала не так хорошо, как бы нам хотелось, да и дебажить тесты в невидимом режиме не так уж и круто.</p>
</div>
<div class="paragraph">
<p>Selenoid же был решением, которое очень хотелось попробовать в реальной работе. Его плюс в том, что настроить его очень просто  при
помощи <a href="http://aerokube.com/cm/latest/">Configuration Manager</a>.</p>
</div>
<div class="paragraph">
<p>Выполняете пару команд:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code>$ curl -L -o cm https://github.com/aerokube/cm/releases/download/1.2.3/cm_linux_amd64
$ chmod +x ./cm
$ ./cm selenoid start --vnc
$ ./cm selenoid-ui start</code></pre>
</div>
</div>
<div class="paragraph">
<p>и у вас уже все настроено и работает. У нас это все заняло 10 минут (версия докера не подходила и нам его пришлось обновлять) =)</p>
</div>
<div class="paragraph">
<p>Всего через неделю использования мы забыли о том, что такое локальный запуск браузера. При наличии VNC можно абсолютно спокойно дебажить тесты прямо на удаленной
машине. Огромным преимуществом, из-за которого я вообще посмотрел в сторону Selenoid, является запуск контейнера по запросу и повторяемость окружения.
У вас всегда известна версия браузера, в котором будут бежать тесты. Всегда создается новый контейнер под новую сессию. Больше нету неожиданных автообновлений
хрома или файрфокса. Более того, мы полечили синдром "А у меня локально работает!", так как все запускают тесты только удаленно.</p>
</div>
<div class="paragraph">
<p>Минусы есть?</p>
</div>
<div class="paragraph">
<p>Пока что у нас почему-то проскакивает ошибка <code>Could not create remote session</code>. Случается она редко и лечится банальным перезапуском, но все же неприятно.
Да и проблема, скорее всего, у нас в коде. Еще в контейнере не работает команда driver.manage.window.maximize(), поэтому приходится ставить размер окна явно.</p>
</div>
<div class="paragraph">
<p>Мы используем Selenide (на Kirk мы пишем пока только один проект) и написали свой <code>SelenoidDriverProvider</code>.
Специально приведу пример кода, так как многие часто задают один и тот же вопрос: а как настроить? Так как у Selenide с документацией, скажем откровенно,
"проблемы", можете опираться на пример ниже:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code>public class SelenoidWebDriverProvider implements WebDriverProvider {
  @Override
  public WebDriver createDriver(DesiredCapabilities capabilities) {
    DesiredCapabilities browser = new DesiredCapabilities();
    browser.setBrowserName("chrome");
    browser.setVersion("59.0");
    browser.setCapability("enableVNC", true);

    try {
      RemoteWebDriver driver = new RemoteWebDriver(
              URI.create("http://172.28.27.17:4444/wd/hub").toURL(),
              browser
      );
      driver.manage().window().setSize(new Dimension(1280, 1024));
      return driver;
    } catch (MalformedURLException e) {
      throw new RuntimeException(e);
    }
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>В коде это можно использовать так:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code>Configuration.browser = "com.tests.utils.SelenoidWebDriverProvider"</code></pre>
</div>
</div>
<div class="paragraph">
<p>В целом я очень доволен и мы получаем реальный профит. Что мы еще не пробовали, так это обновляться. В новой версии Selenoid добавили возможность
сетить имя для контейнера, чтобы можно было по имени легко определить нужную VNC сессию. Вот это мы пока не тестили, так что все еще гадаем, на какой табке кино смотреть =)</p>
</div>
<div class="paragraph">
<p><strong>P/S</strong> Приятная новость: автор Selenoid будет выступать с докладом на конференции <a href="http://qafest.com/">QAFest</a>, поэтому у всех посетителей
будет возможность не только послушать доклад, но и познакомиться лично. Собственно, это я и собираюсь сделать. Тоже буду там
выступать, но об этом уже в следующей заметке.</p>
</div>
                            </section>

                            <footer class="post-footer">
                                   <div class="post-tags">
                                           <a class="btn btn-sm btn-outline-dark tag" href="/tags/Java.html">Java</a>
                                   </div>

                            </footer>

                            <div class="row pl-3 pr-3 training-banner-container">
                                                                    <div class="col text-center pb-3 pt-2 training-banner">
                                                                        <a href="/trainings">Доступные тренинги по автоматизации тестирования: Java API, Java UI, Python API, Jenkins CI</a>
                                                                    </div>
                                                        </div>

                            <div class="sidebar-social">
                                <h5>Подпишись:</h5>
                                <ul>
                                <li>
                                <a href="https://t.me/automation_remarks_bot" class="telegram" target="_blank" rel="nofollow">
                                  <i class="fa fa-telegram" aria-hidden="true"></i>
                                  <span>Telegram</span>
                                </a>
                                </li>

                                <li>
                                <a href="https://www.patreon.com/automation_remarks?filters[tag]=%D0%B2%D0%B5%D1%87%D0%B5%D1%80%20%D0%B3%D1%80%D1%8F%D0%B7%D0%B8" class="podcast" target="_blank" rel="nofollow">
                                  <i class="fa fa-podcast" aria-hidden="true"></i>
                                  <span>Подкаст</span>
                                </a>
                                </li>

                                <li>
                                <a href="https://www.youtube.com/qaguild" class="youtube" target="_blank" rel="nofollow">
                                <i class="fa fa-youtube-play" aria-hidden="true"></i>
                                  <span>Youtube</span>
                                </a>
                                </li>

                                <li>
                                   <a href="https://www.patreon.com/automation_remarks" class="support" target="_blank" rel="9nofollow">
                                   <i class="fa fa-money" aria-hidden="true"></i>
                                      <span>Patreon</span>
                                   </a>
                                </li>


                            </div>




                            <div class="row">
                                  <div class="col-md-12">
                                        <div class='related-posts-holder'>
                                             <h2 class="related-posts-header">Похожие заметки:</h2>
                                                 <div class="card-deck">

                                                        <div class="card bg-light mb-3">
                                                         <a class="linked-card rel-card h-100" target="blank" href="/2022/python-webdriver-manager/index.html">
                                                            <div class="related-card card-body d-flex flex-column">
                                                              <p class="card-text">
                                                                      <small class="text-muted"><span class="post-date">24 May 2022</span></small>
                                                              </p>
                                                              <h5 class="card-title">
                                                                  <!-- <a href="/2022/python-webdriver-manager/index.html"> -->
                                                                    Python Webdriver manager
                                                                  <!-- </a> -->
                                                              </h5>

                                                              <!--
                                                              <p class="card-text">
                                                                   About Python Webdriver manager
                                                              </p>
                                                              -->
                                                              <!-- <a href="/2022/python-webdriver-manager/index.html" class="mt-auto card-link">
                                                                Читать<i class="fa fa-chevron-right ml-1"></i>
                                                              </a> -->
                                                            </div>
                                                            </a>
                                                        </div>


                                                        <div class="card bg-light mb-3">
                                                         <a class="linked-card rel-card h-100" target="blank" href="/2022/qaguild-live62/index.html">
                                                            <div class="related-card card-body d-flex flex-column">
                                                              <p class="card-text">
                                                                      <small class="text-muted"><span class="post-date">07 May 2022</span></small>
                                                              </p>
                                                              <h5 class="card-title">
                                                                  <!-- <a href="/2022/qaguild-live62/index.html"> -->
                                                                    Вечір бруду - новини світу тестування за квітень 2022
                                                                  <!-- </a> -->
                                                              </h5>

                                                              <!--
                                                              <p class="card-text">
                                                                   Незважаючи на війну та умови, ми продовжуємо робити огляд новин зі світу тестування
                                                              </p>
                                                              -->
                                                              <!-- <a href="/2022/qaguild-live62/index.html" class="mt-auto card-link">
                                                                Читать<i class="fa fa-chevron-right ml-1"></i>
                                                              </a> -->
                                                            </div>
                                                            </a>
                                                        </div>


                                                        <div class="card bg-light mb-3">
                                                         <a class="linked-card rel-card h-100" target="blank" href="/2022/qaguild-live61/index.html">
                                                            <div class="related-card card-body d-flex flex-column">
                                                              <p class="card-text">
                                                                      <small class="text-muted"><span class="post-date">19 April 2022</span></small>
                                                              </p>
                                                              <h5 class="card-title">
                                                                  <!-- <a href="/2022/qaguild-live61/index.html"> -->
                                                                    Почему разделение на QA Manual и QA Automation - это ошибка!
                                                                  <!-- </a> -->
                                                              </h5>

                                                              <!--
                                                              <p class="card-text">
                                                                   В этом видео поговорили про разделение на QA Manual и QA Automation
                                                              </p>
                                                              -->
                                                              <!-- <a href="/2022/qaguild-live61/index.html" class="mt-auto card-link">
                                                                Читать<i class="fa fa-chevron-right ml-1"></i>
                                                              </a> -->
                                                            </div>
                                                            </a>
                                                        </div>


                                                        <div class="card bg-light mb-3">
                                                         <a class="linked-card rel-card h-100" target="blank" href="/2021/qaguild-live60/index.html">
                                                            <div class="related-card card-body d-flex flex-column">
                                                              <p class="card-text">
                                                                      <small class="text-muted"><span class="post-date">31 December 2021</span></small>
                                                              </p>
                                                              <h5 class="card-title">
                                                                  <!-- <a href="/2021/qaguild-live60/index.html"> -->
                                                                    Итоги года 2021 для тестировщика | QAGuild #60
                                                                  <!-- </a> -->
                                                              </h5>

                                                              <!--
                                                              <p class="card-text">
                                                                   В этом видео поговорили про итоги 2021 года в сфере тестирования.
                                                              </p>
                                                              -->
                                                              <!-- <a href="/2021/qaguild-live60/index.html" class="mt-auto card-link">
                                                                Читать<i class="fa fa-chevron-right ml-1"></i>
                                                              </a> -->
                                                            </div>
                                                            </a>
                                                        </div>

                                                 </div>
                                         </div>
                                  </div>
                                  <div class="col-md-6">

                                  </div>
                            </div>
                        </div>
                    </div>
                </article>
            </main>
       </div>
    </div>
    <footer class="text-muted page-footer fixed-bottom">
      <div class="container">

      </div>
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="../../../js/jquery-3.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script>window.jQuery || document.write('<script src="../../assets/js/vendor/jquery-slim.min.js"><\/script>')</script>
    <script src="../../../js/popper.js"></script>
    <script src="../../../js/bootstrap.js"></script>
    <script src="../../../js/holder.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.0.0/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="https://w.soundcloud.com/player/api.js"></script>
    <script src="../../../js/script.js"></script>
    <script src="https://use.fontawesome.com/e0e0cff5da.js"></script>
    <script async src="https://cse.google.com/cse.js?cx=005666829887305506139:i4vgkrjldvk"></script>
    <script src="https://my.hellobar.com/b89babe68c85bfcf7416926983e86b31a9467186.js" type="text/javascript" charset="utf-8" async="async"></script>
    </body>
</html>
